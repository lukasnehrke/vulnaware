import { Component } from "./bom.model";

export type VulnerabilityPage = {
    page: number;
    totalItems: number;
    vulnerabilities: Vulnerability[];
};

export type Vulnerability = {
    id: string;
    status: string;
    comment?: string;
    createdAt: string;
    advisory: {
        id: string;
        type: string;
        risk?: number;
        summary?: string;
        osv?: {
            id: string;
            published?: string;
            modified?: string;
            summary?: string;
            details?: string;
            aliases?: string[];
            affected: {
                package: {
                    ecosystem: string;
                    name: string;
                };
            }[];
            references?: [{ type: string; url: string }];
        };
        nvd?: {
            cve: {
                published: string;
                descriptions: {
                    lang: string;
                    value: string;
                }[];
                references?: [{ source: string; url: string }];
            };
        };
    };
    components: Component[];
};
